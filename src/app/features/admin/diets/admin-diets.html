<div class="admin-diets-container">
    <div class="header">
        <h1 class="page-title">GestiÃ³n de Recetas</h1>
        <button class="create-btn" (click)="openCreateModal()">
            <span class="icon">+</span> Nueva Receta
        </button>
    </div>

    <div class="filters">
        <div class="search-box">
            <input type="text" placeholder="Buscar recetas..." [(ngModel)]="searchTerm" (input)="filterRecipes()"
                class="search-input">
            <span class="search-icon">ğŸ”</span>
        </div>
    </div>

    @if (loading) {
    <div class="loading">Cargando recetas...</div>
    } @else {
    <div class="recipes-grid">
        @for (recipe of filteredRecipes; track recipe.id) {
        <div class="recipe-card" (click)="openViewModal(recipe)">
            <div class="recipe-image">
                <img [src]="recipe.image_url || recipe.image || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop'"
                    [alt]="recipe.name"
                    (error)="$event.target.src='https://via.placeholder.com/400x300/cccccc/666666?text=No+Image'">
                <div class="recipe-actions">
                    <button class="action-btn edit" (click)="openEditModal(recipe, $event)" title="Editar">âœ</button>
                    <button class="action-btn delete" (click)="deleteRecipe(recipe.id, $event)"
                        title="Eliminar">ğŸ—‘</button>
                </div>
            </div>
            <div class="recipe-content">
                <h3 class="recipe-title">{{ recipe.name }}</h3>
                <p class="recipe-desc">{{ recipe.short_description }}</p>
                <div class="recipe-meta">
                    <span class="meta-item">ğŸ”¥ {{ recipe.nutrition?.per_serving?.calories_kcal || 0 }} kcal</span>
                    <span class="meta-item">â± {{ recipe.preparation ? '30 min' : 'N/A' }}</span>
                </div>
            </div>
        </div>
        }
    </div>
    }

    @if (filteredRecipes.length === 0 && !loading) {
    <div class="empty-state">
        <p>No se encontraron recetas.</p>
    </div>
    }
</div>

@if (showModal) {
<app-recipe-form [recipe]="selectedRecipe" (save)="handleSave($event)" (cancel)="closeModal()">
</app-recipe-form>
}

@if (viewingRecipe) {
<app-recipe-detail-modal [recipe]="viewingRecipe" (close)="closeViewModal()">
</app-recipe-detail-modal>
}