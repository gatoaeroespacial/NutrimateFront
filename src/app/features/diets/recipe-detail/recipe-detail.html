@if (loading) {
<div class="loading-container">
  <div class="spinner"></div>
  <p>Cargando receta...</p>
</div>
}

@if (!loading && recipe) {
<div class="recipe-detail-container">
  <button class="back-button" (click)="goBack()">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
      <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
    </svg>
    Volver al Plan
  </button>

  <div class="recipe-header">
    <div class="recipe-info">
      <h1 class="recipe-title">{{ recipe.name }}</h1>
      <p class="recipe-description">{{ recipe.description }}</p>

      <div class="recipe-actions">
        <button class="action-button primary">
          <span class="icon">üçΩÔ∏è</span>
          Comida
        </button>
        <button class="action-button secondary">
          <span class="icon">ü•ó</span>
          Comer M√°s Saludable
        </button>
      </div>
    </div>
  </div>

  <div class="recipe-content">
    <!-- Ingredientes -->
    @if (recipe.ingredients && recipe.ingredients.length > 0) {
    <div class="section ingredients-section">
      <h2 class="section-title">
        <span class="icon">ü•ï</span>
        Ingredientes
      </h2>
      <div class="ingredients-grid">
        @for (ingredient of recipe.ingredients; track $index) {
        <div class="ingredient-item">
          <span class="bullet">‚Ä¢</span>
          {{ ingredient }}
        </div>
        }
      </div>
    </div>
    }

    <!-- Preparaci√≥n -->
    @if (recipe.preparation_steps) {
    <div class="section preparation-section">
      <h2 class="section-title">
        <span class="icon">üë®‚Äçüç≥</span>
        Modo de Preparaci√≥n
      </h2>
      <p class="preparation-text">{{ recipe.preparation_steps }}</p>
    </div>
    }

    <!-- Informaci√≥n Nutricional -->
    @if (recipe.nutritional_info) {
    <div class="section nutrition-section">
      <h2 class="section-title">
        <span class="icon">üìä</span>
        Informaci√≥n Nutricional
      </h2>

      @if (recipe.nutritional_info.per_serving) {
      <div class="nutrition-table">
        <h3 class="nutrition-subtitle">Por Porci√≥n</h3>
        <div class="nutrition-grid">
          @if (recipe.nutritional_info.per_serving.serving_g) {
          <div class="nutrition-item">
            <span class="nutrition-label">Porci√≥n</span>
            <span class="nutrition-value">{{ recipe.nutritional_info.per_serving.serving_g }} g</span>
          </div>
          }
          @if (recipe.nutritional_info.per_serving.calories_kcal !== null &&
          recipe.nutritional_info.per_serving.calories_kcal !== undefined) {
          <div class="nutrition-item highlight">
            <span class="nutrition-label">Calor√≠as</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_serving.calories_kcal) }}
              kcal</span>
          </div>
          }
          @if (recipe.nutritional_info.per_serving.protein_g !== null && recipe.nutritional_info.per_serving.protein_g
          !== undefined) {
          <div class="nutrition-item">
            <span class="nutrition-label">Prote√≠nas</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_serving.protein_g) }}
              g</span>
          </div>
          }
          @if (recipe.nutritional_info.per_serving.carbs_g !== null && recipe.nutritional_info.per_serving.carbs_g !==
          undefined) {
          <div class="nutrition-item">
            <span class="nutrition-label">Carbohidratos</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_serving.carbs_g) }} g</span>
          </div>
          }
          @if (recipe.nutritional_info.per_serving.fat_g !== null && recipe.nutritional_info.per_serving.fat_g !==
          undefined) {
          <div class="nutrition-item">
            <span class="nutrition-label">Grasas</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_serving.fat_g) }} g</span>
          </div>
          }
          @if (recipe.nutritional_info.per_serving.saturated_fat_g !== null &&
          recipe.nutritional_info.per_serving.saturated_fat_g !== undefined) {
          <div class="nutrition-item">
            <span class="nutrition-label">Grasas Saturadas</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_serving.saturated_fat_g) }}
              g</span>
          </div>
          }
          @if (recipe.nutritional_info.per_serving.sugars_g !== null && recipe.nutritional_info.per_serving.sugars_g !==
          undefined) {
          <div class="nutrition-item">
            <span class="nutrition-label">Az√∫cares</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_serving.sugars_g) }} g</span>
          </div>
          }
        </div>
      </div>
      }

      @if (recipe.nutritional_info.per_100g) {
      <div class="nutrition-table">
        <h3 class="nutrition-subtitle">Por 100g</h3>
        <div class="nutrition-grid">
          @if (recipe.nutritional_info.per_100g.calories_kcal !== null && recipe.nutritional_info.per_100g.calories_kcal
          !== undefined) {
          <div class="nutrition-item highlight">
            <span class="nutrition-label">Calor√≠as</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_100g.calories_kcal) }}
              kcal</span>
          </div>
          }
          @if (recipe.nutritional_info.per_100g.protein_g !== null && recipe.nutritional_info.per_100g.protein_g !==
          undefined) {
          <div class="nutrition-item">
            <span class="nutrition-label">Prote√≠nas</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_100g.protein_g) }} g</span>
          </div>
          }
          @if (recipe.nutritional_info.per_100g.fat_g !== null && recipe.nutritional_info.per_100g.fat_g !== undefined)
          {
          <div class="nutrition-item">
            <span class="nutrition-label">Grasas</span>
            <span class="nutrition-value">{{ getNutritionValue(recipe.nutritional_info.per_100g.fat_g) }} g</span>
          </div>
          }
        </div>
      </div>
      }
    </div>
    }
  </div>
</div>
}

@if (!loading && !recipe) {
<div class="not-found">
  <div class="not-found-icon">üîç</div>
  <h2>Receta no encontrada</h2>
  <p>Lo sentimos, la receta que buscas no est√° disponible.</p>
  <button class="back-button" (click)="goBack()">Volver al Plan</button>
</div>
}